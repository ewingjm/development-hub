[{"filePath":"C:\\Users\\maxew\\Repos\\github\\development-hub\\src\\solutions\\devhub_DevelopmentHub_Develop\\WebResources\\Scripts\\src\\develop.common.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'DevelopmentHub' is defined but never used.","line":1,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":25},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Develop' is defined but never used.","line":1,"column":26,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":33},{"ruleId":"class-methods-use-this","severity":2,"message":"Expected 'this' to be used by class method 'getMetadata'.","line":14,"column":23,"nodeType":"FunctionExpression","messageId":"missingThis","endLine":30,"endColumn":6},{"ruleId":"max-len","severity":2,"message":"This line has a length of 120. Maximum allowed is 100.","line":33,"column":1,"nodeType":"Program","messageId":"max","endLine":33,"endColumn":121},{"ruleId":"import/prefer-default-export","severity":2,"message":"Prefer default export.","line":33,"column":3,"nodeType":"ExportNamedDeclaration","endLine":47,"endColumn":4},{"ruleId":"@typescript-eslint/no-use-before-define","severity":2,"message":"'onExecuteWorkflowResponse' was used before it was defined.","line":44,"column":21,"nodeType":"Identifier","messageId":"noUseBeforeDefine","endLine":44,"endColumn":46},{"ruleId":"@typescript-eslint/no-use-before-define","severity":2,"message":"'onExecuteWorkflowError' was used before it was defined.","line":45,"column":20,"nodeType":"Identifier","messageId":"noUseBeforeDefine","endLine":45,"endColumn":42},{"ruleId":"no-inner-declarations","severity":2,"message":"Move function declaration to program root.","line":49,"column":3,"nodeType":"FunctionDeclaration","messageId":"moveDeclToRoot","endLine":67,"endColumn":4},{"ruleId":"no-inner-declarations","severity":2,"message":"Move function declaration to program root.","line":69,"column":3,"nodeType":"FunctionDeclaration","messageId":"moveDeclToRoot","endLine":76,"endColumn":4}],"errorCount":9,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"namespace DevelopmentHub.Develop {\n  class ExecuteWorkflowRequest {\n    public entity: Xrm.LookupValue;\n\n    public EntityId: { guid: string };\n\n    constructor(workflow: Xrm.LookupValue, recordId: string) {\n      this.entity = workflow;\n      this.EntityId = {\n        guid: recordId,\n      };\n    }\n\n    public getMetadata() {\n      return {\n        boundParameter: 'entity',\n        operationType: 0,\n        operationName: 'ExecuteWorkflow',\n        parameterTypes: {\n          entity: {\n            typeName: 'mscrm.workflow',\n            structuralProperty: 5,\n          },\n          EntityId: {\n            typeName: 'Edm.Guid',\n            structuralProperty: 1,\n          },\n        },\n      };\n    }\n  }\n\n  export function executeWorkflow(workflowId: string, recordId: string, text: string, primaryControl: Xrm.FormContext) {\n    Xrm.Utility.showProgressIndicator(text);\n\n    const workflow: Xrm.LookupValue = {\n      entityType: 'workflow',\n      id: workflowId,\n    };\n\n    Xrm.WebApi.online\n      .execute(new ExecuteWorkflowRequest(workflow, recordId))\n      .then(\n        (result) => onExecuteWorkflowResponse(result, primaryControl),\n        (error) => onExecuteWorkflowError(error),\n      );\n  }\n\n  function onExecuteWorkflowResponse(result: Xrm.ExecuteResponse, primaryControl: Xrm.FormContext) {\n    if (!result.ok) {\n      return;\n    }\n\n    primaryControl.data\n      .refresh(true)\n      .then(\n        primaryControl.ui.refreshRibbon,\n        (err) => {\n          Xrm.Navigation.openErrorDialog({\n            message: err.message,\n            errorCode: err.errorCode,\n          });\n        },\n      );\n\n    Xrm.Utility.closeProgressIndicator();\n  }\n\n  function onExecuteWorkflowError(error: Xrm.ErrorResponse) {\n    Xrm.Utility.closeProgressIndicator();\n\n    Xrm.Navigation.openErrorDialog({\n      message: error.message,\n      errorCode: error.errorCode,\n    });\n  }\n}\n","usedDeprecatedRules":[{"ruleId":"lines-around-directive","replacedBy":["padding-line-between-statements"]},{"ruleId":"no-spaced-func","replacedBy":["func-call-spacing"]},{"ruleId":"global-require","replacedBy":[]},{"ruleId":"no-buffer-constructor","replacedBy":[]},{"ruleId":"no-new-require","replacedBy":[]},{"ruleId":"no-path-concat","replacedBy":[]}]},{"filePath":"C:\\Users\\maxew\\Repos\\github\\development-hub\\src\\solutions\\devhub_DevelopmentHub_Develop\\WebResources\\Scripts\\src\\develop.issue.ribbon.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'DevelopmentHub' is defined but never used.","line":1,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":25},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Develop' is defined but never used.","line":1,"column":26,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":33},{"ruleId":"class-methods-use-this","severity":2,"message":"Expected 'this' to be used by class method 'getMetadata'.","line":9,"column":23,"nodeType":"FunctionExpression","messageId":"missingThis","endLine":21,"endColumn":6},{"ruleId":"max-len","severity":2,"message":"This line has a length of 129. Maximum allowed is 100.","line":49,"column":1,"nodeType":"Program","messageId":"max","endLine":49,"endColumn":130}],"errorCount":4,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"namespace DevelopmentHub.Develop {\n  class StartDevelopingRequest {\n    public entity: Xrm.LookupValue;\n\n    constructor(entity: Xrm.LookupValue) {\n      this.entity = entity;\n    }\n\n    public getMetadata() {\n      return {\n        boundParameter: 'entity',\n        operationType: 0,\n        operationName: 'devhub_StartDeveloping',\n        parameterTypes: {\n          entity: {\n            typeName: 'mscrm.devhub_issue',\n            structuralProperty: 5,\n          },\n        },\n      };\n    }\n  }\n\n  export async function startDeveloping(primaryControl: Xrm.FormContext): Promise<void> {\n    Xrm.Utility.showProgressIndicator('Creating development solution');\n    let result: Xrm.ExecuteResponse;\n    try {\n      result = await Xrm.WebApi.online.execute(\n        new StartDevelopingRequest(primaryControl.data.entity.getEntityReference()),\n      );\n    } catch (ex) {\n      Xrm.Utility.closeProgressIndicator();\n      const errorResponse: Xrm.ErrorResponse = ex;\n      Xrm.Navigation.openErrorDialog({\n        message: errorResponse.message,\n        errorCode: errorResponse.errorCode,\n      });\n    }\n\n    Xrm.Utility.closeProgressIndicator();\n\n    if (result.ok) {\n      primaryControl.data.refresh(false);\n    }\n  }\n\n  export function isStartDevelopingEnabled(primaryControl: Xrm.FormContext): boolean {\n    const statusCode: Xrm.Attributes.OptionSetAttribute = primaryControl.getAttribute('statuscode');\n    return statusCode.getValue() === devhub_issue_statuscode.ToDo && primaryControl.ui.getFormType() === XrmEnum.FormType.Update;\n  }\n}\n","usedDeprecatedRules":[{"ruleId":"lines-around-directive","replacedBy":["padding-line-between-statements"]},{"ruleId":"no-spaced-func","replacedBy":["func-call-spacing"]},{"ruleId":"global-require","replacedBy":[]},{"ruleId":"no-buffer-constructor","replacedBy":[]},{"ruleId":"no-new-require","replacedBy":[]},{"ruleId":"no-path-concat","replacedBy":[]}]},{"filePath":"C:\\Users\\maxew\\Repos\\github\\development-hub\\src\\solutions\\devhub_DevelopmentHub_Develop\\WebResources\\Scripts\\src\\develop.solutionmerge.ribbon.ts","messages":[{"ruleId":"max-classes-per-file","severity":2,"message":"File has too many classes (2). Maximum allowed is 1.","line":1,"column":1,"nodeType":"Program","messageId":"maximumExceeded","endLine":98,"endColumn":1},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'DevelopmentHub' is defined but never used.","line":1,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":25},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Develop' is defined but never used.","line":1,"column":26,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":33},{"ruleId":"class-methods-use-this","severity":2,"message":"Expected 'this' to be used by class method 'getMetadata'.","line":9,"column":23,"nodeType":"FunctionExpression","messageId":"missingThis","endLine":21,"endColumn":6},{"ruleId":"class-methods-use-this","severity":2,"message":"Expected 'this' to be used by class method 'getMetadata'.","line":31,"column":23,"nodeType":"FunctionExpression","messageId":"missingThis","endLine":43,"endColumn":6},{"ruleId":"@typescript-eslint/no-use-before-define","severity":2,"message":"'executeWebApiRequest' was used before it was defined.","line":59,"column":5,"nodeType":"Identifier","messageId":"noUseBeforeDefine","endLine":59,"endColumn":25},{"ruleId":"@typescript-eslint/no-use-before-define","severity":2,"message":"'executeWebApiRequest' was used before it was defined.","line":72,"column":5,"nodeType":"Identifier","messageId":"noUseBeforeDefine","endLine":72,"endColumn":25},{"ruleId":"no-inner-declarations","severity":2,"message":"Move function declaration to program root.","line":76,"column":3,"nodeType":"FunctionDeclaration","messageId":"moveDeclToRoot","endLine":84,"endColumn":4},{"ruleId":"@typescript-eslint/no-shadow","severity":2,"message":"'reject' is already declared in the upper scope.","line":77,"column":34,"nodeType":"Identifier","messageId":"noShadow","endLine":77,"endColumn":40},{"ruleId":"@typescript-eslint/no-use-before-define","severity":2,"message":"'handleActionResponse' was used before it was defined.","line":80,"column":15,"nodeType":"Identifier","messageId":"noUseBeforeDefine","endLine":80,"endColumn":35},{"ruleId":"@typescript-eslint/no-use-before-define","severity":2,"message":"'handleActionError' was used before it was defined.","line":80,"column":37,"nodeType":"Identifier","messageId":"noUseBeforeDefine","endLine":80,"endColumn":54},{"ruleId":"no-inner-declarations","severity":2,"message":"Move function declaration to program root.","line":86,"column":3,"nodeType":"FunctionDeclaration","messageId":"moveDeclToRoot","endLine":88,"endColumn":4},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'response' is defined but never used.","line":86,"column":33,"nodeType":"Identifier","messageId":"unusedVar","endLine":86,"endColumn":62},{"ruleId":"no-inner-declarations","severity":2,"message":"Move function declaration to program root.","line":90,"column":3,"nodeType":"FunctionDeclaration","messageId":"moveDeclToRoot","endLine":96,"endColumn":4}],"errorCount":14,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"namespace DevelopmentHub.Develop {\n  class ApproveRequest {\n    public entity: Xrm.LookupValue;\n\n    constructor(entity: Xrm.LookupValue) {\n      this.entity = entity;\n    }\n\n    public getMetadata() {\n      return {\n        boundParameter: 'entity',\n        operationType: 0,\n        operationName: 'devhub_Approve',\n        parameterTypes: {\n          entity: {\n            typeName: 'mscrm.devhub_solutionmerge',\n            structuralProperty: 5,\n          },\n        },\n      };\n    }\n  }\n\n  class RejectRequest {\n    public entity: Xrm.LookupValue;\n\n    constructor(entity: Xrm.LookupValue) {\n      this.entity = entity;\n    }\n\n    public getMetadata() {\n      return {\n        boundParameter: 'entity',\n        operationType: 0,\n        operationName: 'devhub_Reject',\n        parameterTypes: {\n          entity: {\n            typeName: 'mscrm.devhub_solutionmerge',\n            structuralProperty: 5,\n          },\n        },\n      };\n    }\n  }\n\n  export function isReviewEnabled(primaryControl: Xrm.FormContext): boolean {\n    return primaryControl.getAttribute('statuscode').getValue() === devhub_solutionmerge_statuscode.AwaitingReview\n            && primaryControl.ui.getFormType() !== XrmEnum.FormType.Create;\n  }\n\n  export function retry(primaryControl: Xrm.FormContext): void {\n    primaryControl.getAttribute('statuscode').setValue(353400000);\n    primaryControl.data.save();\n  }\n\n  export function approve(primaryControl: Xrm.FormContext): void {\n    const entity = primaryControl.data.entity.getEntityReference();\n\n    executeWebApiRequest(new ApproveRequest(entity), 'Approving solution merge.')\n      .then(async () => {\n        // Flows don't trigger for updates done within actions/workflows.\n        // Setting the statuscode here as a workaround\n        primaryControl.getAttribute('statuscode').setValue(353400000);\n        await primaryControl.data.save();\n        primaryControl.data.refresh(false);\n      });\n  }\n\n  export function reject(primaryControl: Xrm.FormContext): void {\n    const entity = primaryControl.data.entity.getEntityReference();\n\n    executeWebApiRequest(new RejectRequest(entity), 'Rejecting solution merge.')\n      .then(() => primaryControl.data.refresh(false));\n  }\n\n  function executeWebApiRequest(request: any, progressIndicator: string): Promise<void> {\n    return new Promise((resolve, reject) => {\n      Xrm.Utility.showProgressIndicator(progressIndicator);\n      Xrm.WebApi.online.execute(request)\n        .then(handleActionResponse, handleActionError)\n        .then(resolve)\n        .catch(reject);\n    });\n  }\n\n  function handleActionResponse(response: Xrm.ExecuteResponse) {\n    Xrm.Utility.closeProgressIndicator();\n  }\n\n  function handleActionError(err: { message: string, errorCode: number }) {\n    Xrm.Utility.closeProgressIndicator();\n    Xrm.Navigation.openErrorDialog({\n      message: err.message,\n      errorCode: err.errorCode,\n    });\n  }\n}\n","usedDeprecatedRules":[{"ruleId":"lines-around-directive","replacedBy":["padding-line-between-statements"]},{"ruleId":"no-spaced-func","replacedBy":["func-call-spacing"]},{"ruleId":"global-require","replacedBy":[]},{"ruleId":"no-buffer-constructor","replacedBy":[]},{"ruleId":"no-new-require","replacedBy":[]},{"ruleId":"no-path-concat","replacedBy":[]}]},{"filePath":"C:\\Users\\maxew\\Repos\\github\\development-hub\\src\\solutions\\devhub_DevelopmentHub_Develop\\WebResources\\Scripts\\types\\devhub_issue.d.ts","messages":[{"ruleId":"@typescript-eslint/naming-convention","severity":2,"message":"Enum name `devhub_issue_statuscode` must match one of the following formats: PascalCase","line":1,"column":20,"nodeType":"Identifier","messageId":"doesNotMatchFormat","endLine":1,"endColumn":43}],"errorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"declare const enum devhub_issue_statuscode {\n  ToDo = 1,\n  Cancelled = 2,\n}\n","usedDeprecatedRules":[{"ruleId":"lines-around-directive","replacedBy":["padding-line-between-statements"]},{"ruleId":"no-spaced-func","replacedBy":["func-call-spacing"]},{"ruleId":"global-require","replacedBy":[]},{"ruleId":"no-buffer-constructor","replacedBy":[]},{"ruleId":"no-new-require","replacedBy":[]},{"ruleId":"no-path-concat","replacedBy":[]}]},{"filePath":"C:\\Users\\maxew\\Repos\\github\\development-hub\\src\\solutions\\devhub_DevelopmentHub_Develop\\WebResources\\Scripts\\types\\devhub_solutionmerge.d.ts","messages":[{"ruleId":"@typescript-eslint/naming-convention","severity":2,"message":"Enum name `devhub_solutionmerge_statuscode` must match one of the following formats: PascalCase","line":1,"column":20,"nodeType":"Identifier","messageId":"doesNotMatchFormat","endLine":1,"endColumn":51}],"errorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"declare const enum devhub_solutionmerge_statuscode {\n  AwaitingReview = 1,\n}\n","usedDeprecatedRules":[{"ruleId":"lines-around-directive","replacedBy":["padding-line-between-statements"]},{"ruleId":"no-spaced-func","replacedBy":["func-call-spacing"]},{"ruleId":"global-require","replacedBy":[]},{"ruleId":"no-buffer-constructor","replacedBy":[]},{"ruleId":"no-new-require","replacedBy":[]},{"ruleId":"no-path-concat","replacedBy":[]}]}]